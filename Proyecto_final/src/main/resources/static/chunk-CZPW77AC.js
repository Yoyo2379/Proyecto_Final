import{a as G}from"./chunk-R7N6EZJW.js";import{a as K,b as U,c as X,d as Y,e as Z,f as tt,g as et,h as it,i as nt,j as at,k as ot,l as rt,m as ft,n as y,o as gt,p as E,q as Ct,r as ht,s as Tt,t as vt,u as St,v as kt,w as Mt}from"./chunk-UU6YQF4W.js";import{a as J}from"./chunk-KAZCH7JP.js";import{a as A,b as Q}from"./chunk-36AWM7YG.js";import{a as ut}from"./chunk-QN3EYHTV.js";import{a as lt,f as st,g as mt,j as pt,k as ct,l as _t,m as xt}from"./chunk-KCIO37WG.js";import{P as dt}from"./chunk-5Z4GIFAT.js";import{a as H,b as V,c as z,d as B,e as W}from"./chunk-QXNWF3HH.js";import{d as F,e as j,h as O,ma as $,oa as N,pa as q,r as R}from"./chunk-OLD2AYRY.js";import{Cb as _,Db as u,Fb as w,Jb as c,Kb as f,Ob as b,Pa as l,Pb as L,Qb as P,Y as g,Yb as o,Zb as T,_b as S,ac as k,ba as C,bc as x,ca as h,cb as D,cc as M,fc as I,ib as p,vb as d,wb as n,xb as a,yb as v}from"./chunk-YGIBANMM.js";import"./chunk-7CGTOI24.js";var Et=()=>[5,10,25,50];function wt(e,t){if(e&1&&(n(0,"mat-option",4),o(1),a()),e&2){let i=t.$implicit;d("value",i.id),l(),S(" ",i.name," ")}}function bt(e,t){e&1&&v(0,"app-loading")}function Lt(e,t){e&1&&(n(0,"th",30),o(1,"T\xEDtulo"),a())}function Pt(e,t){if(e&1&&(n(0,"td",31),o(1),a()),e&2){let i=t.$implicit;l(),T(i.title)}}function Dt(e,t){e&1&&(n(0,"th",32),o(1,"Descripci\xF3n"),a())}function It(e,t){if(e&1&&(n(0,"td",31),o(1),a()),e&2){let i=t.$implicit;l(),T(i.description)}}function Ft(e,t){e&1&&(n(0,"th",30),o(1,"Estado"),a())}function jt(e,t){if(e&1&&(n(0,"td",31)(1,"mat-chip",33),o(2),a()()),e&2){let i=t.$implicit,r=f(2);l(),d("color",r.getStatusColor(i.status)),l(),S(" ",r.getStatusLabel(i.status)," ")}}function Ot(e,t){e&1&&(n(0,"th",30),o(1,"Prioridad"),a())}function Rt(e,t){if(e&1&&(n(0,"td",31)(1,"mat-chip",33),o(2),a()()),e&2){let i=t.$implicit,r=f(2);l(),d("color",r.getPriorityColor(i.priority)),l(),S(" ",r.getPriorityLabel(i.priority)," ")}}function Ht(e,t){e&1&&(n(0,"th",32),o(1,"Proyecto"),a())}function Vt(e,t){if(e&1&&(n(0,"td",31),o(1),a()),e&2){let i=t.$implicit;l(),T((i.project==null?null:i.project.name)||"-")}}function zt(e,t){e&1&&(n(0,"th",32),o(1,"Asignado a"),a())}function Bt(e,t){if(e&1&&(n(0,"td",31),o(1),a()),e&2){let i=t.$implicit;l(),T((i.assignee==null?null:i.assignee.name)||"Sin asignar")}}function Wt(e,t){e&1&&(n(0,"th",32),o(1,"Acciones"),a())}function At(e,t){if(e&1){let i=w();n(0,"td",31)(1,"button",34),c("click",function(){let s=C(i).$implicit,m=f(2);return h(m.onEdit(s))}),n(2,"mat-icon"),o(3,"edit"),a()(),n(4,"button",35),c("click",function(){let s=C(i).$implicit,m=f(2);return h(m.onDelete(s))}),n(5,"mat-icon"),o(6,"delete"),a()()()}}function Qt(e,t){e&1&&v(0,"tr",36)}function $t(e,t){e&1&&v(0,"tr",37)}function Nt(e,t){if(e&1){let i=w();n(0,"div",15)(1,"table",16),c("matSortChange",function(s){C(i);let m=f();return h(m.onSortChange(s))}),_(2,17),p(3,Lt,2,0,"th",18)(4,Pt,2,1,"td",19),u(),_(5,20),p(6,Dt,2,0,"th",21)(7,It,2,1,"td",19),u(),_(8,22),p(9,Ft,2,0,"th",18)(10,jt,3,2,"td",19),u(),_(11,23),p(12,Ot,2,0,"th",18)(13,Rt,3,2,"td",19),u(),_(14,24),p(15,Ht,2,0,"th",21)(16,Vt,2,1,"td",19),u(),_(17,25),p(18,zt,2,0,"th",21)(19,Bt,2,1,"td",19),u(),_(20,26),p(21,Wt,2,0,"th",21)(22,At,7,0,"td",19),u(),p(23,Qt,1,0,"tr",27)(24,$t,1,0,"tr",28),a(),n(25,"mat-paginator",29),c("page",function(s){C(i);let m=f();return h(m.onPageChange(s))}),a()()}if(e&2){let i=f();l(),d("dataSource",i.dataSource),l(22),d("matHeaderRowDef",i.displayedColumns),l(),d("matRowDefColumns",i.displayedColumns),l(),d("length",i.totalElements)("pageSize",i.pageSize)("pageSizeOptions",I(6,Et))}}var yt=class e{taskService=g(G);projectService=g(xt);router=g(R);dialog=g(Tt);displayedColumns=["title","description","status","priority","project","assignee","actions"];dataSource=new rt;projects=[];totalElements=0;pageSize=10;pageIndex=0;sortField="createdAt";sortDirection="desc";loading=!1;filters={};paginator;sort;ngOnInit(){this.loadProjects(),this.loadTasks()}loadProjects(){this.projectService.getAll(0,100).subscribe({next:t=>{this.projects=t.content}})}loadTasks(){this.loading=!0;let t=`${this.sortField},${this.sortDirection}`;this.taskService.getAll(this.pageIndex,this.pageSize,t,this.filters).subscribe({next:i=>{this.dataSource.data=i.content,this.totalElements=i.totalElements,this.loading=!1},error:()=>{this.loading=!1}})}onPageChange(t){this.pageIndex=t.pageIndex,this.pageSize=t.pageSize,this.loadTasks()}onSortChange(t){this.sortField=t.active||"createdAt",this.sortDirection=t.direction||"desc",this.pageIndex=0,this.loadTasks()}onFilterChange(){this.pageIndex=0,this.loadTasks()}clearFilters(){this.filters={},this.pageIndex=0,this.loadTasks()}onCreate(){this.router.navigate(["/tasks/new"])}onEdit(t){this.router.navigate(["/tasks",t.id,"edit"])}onDelete(t){this.dialog.open(Mt,{data:{title:"Eliminar Tarea",message:`\xBFEst\xE1 seguro de eliminar la tarea "${t.title}"?`,confirmText:"Eliminar"}}).afterClosed().subscribe(r=>{r&&this.taskService.delete(t.id).subscribe(()=>{this.loadTasks()})})}getStatusColor(t){return{todo:"warn",in_progress:"primary",completed:"accent"}[t]||"primary"}getStatusLabel(t){return{todo:"Por Hacer",in_progress:"En Progreso",completed:"Completado"}[t]||t}getPriorityColor(t){return{low:"accent",medium:"primary",high:"warn"}[t]||"primary"}getPriorityLabel(t){return{low:"Baja",medium:"Media",high:"Alta"}[t]||t}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-task-list"]],viewQuery:function(i,r){if(i&1&&(b(y,5),b(E,5)),i&2){let s;L(s=P())&&(r.paginator=s.first),L(s=P())&&(r.sort=s.first)}},decls:45,vars:9,consts:[["mat-raised-button","","color","primary",3,"click"],[1,"filters"],["appearance","outline"],[3,"valueChange","selectionChange","value"],[3,"value"],["value","todo"],["value","in_progress"],["value","completed"],["value","low"],["value","medium"],["value","high"],[3,"value",4,"ngFor","ngForOf"],["mat-button","",3,"click"],[4,"ngIf"],["class","table-container",4,"ngIf"],[1,"table-container"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","title"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","status"],["matColumnDef","priority"],["matColumnDef","project"],["matColumnDef","assignee"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"page","length","pageSize","pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],[3,"color"],["mat-icon-button","","matTooltip","Editar",3,"click"],["mat-icon-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,r){i&1&&(n(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),o(3,"Tareas"),a(),n(4,"button",0),c("click",function(){return r.onCreate()}),n(5,"mat-icon"),o(6,"add"),a(),o(7," Nueva Tarea "),a()(),n(8,"mat-card-content")(9,"div",1)(10,"mat-form-field",2)(11,"mat-label"),o(12,"Estado"),a(),n(13,"mat-select",3),M("valueChange",function(m){return x(r.filters.status,m)||(r.filters.status=m),m}),c("selectionChange",function(){return r.onFilterChange()}),n(14,"mat-option",4),o(15,"Todos"),a(),n(16,"mat-option",5),o(17,"Por Hacer"),a(),n(18,"mat-option",6),o(19,"En Progreso"),a(),n(20,"mat-option",7),o(21,"Completado"),a()()(),n(22,"mat-form-field",2)(23,"mat-label"),o(24,"Prioridad"),a(),n(25,"mat-select",3),M("valueChange",function(m){return x(r.filters.priority,m)||(r.filters.priority=m),m}),c("selectionChange",function(){return r.onFilterChange()}),n(26,"mat-option",4),o(27,"Todas"),a(),n(28,"mat-option",8),o(29,"Baja"),a(),n(30,"mat-option",9),o(31,"Media"),a(),n(32,"mat-option",10),o(33,"Alta"),a()()(),n(34,"mat-form-field",2)(35,"mat-label"),o(36,"Proyecto"),a(),n(37,"mat-select",3),M("valueChange",function(m){return x(r.filters.projectId,m)||(r.filters.projectId=m),m}),c("selectionChange",function(){return r.onFilterChange()}),n(38,"mat-option",4),o(39,"Todos"),a(),p(40,wt,2,2,"mat-option",11),a()(),n(41,"button",12),c("click",function(){return r.clearFilters()}),o(42,"Limpiar Filtros"),a()(),p(43,bt,1,0,"app-loading",13)(44,Nt,26,7,"div",14),a()()),i&2&&(l(13),k("value",r.filters.status),l(),d("value",void 0),l(11),k("value",r.filters.priority),l(),d("value",void 0),l(11),k("value",r.filters.projectId),l(),d("value",void 0),l(2),d("ngForOf",r.projects),l(3),d("ngIf",r.loading),l(),d("ngIf",!r.loading))},dependencies:[O,F,j,dt,ot,K,X,et,Y,U,it,Z,tt,nt,at,gt,y,ht,E,Ct,q,N,$,Q,A,W,H,z,B,V,vt,kt,St,pt,st,lt,_t,ct,mt,ft,ut,J],styles:["mat-card[_ngcontent-%COMP%]{margin:1rem}mat-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.filters[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem;flex-wrap:wrap;align-items:center}.filters[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{min-width:200px}.table-container[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%}mat-paginator[_ngcontent-%COMP%]{margin-top:1rem}"]})};export{yt as TaskListComponent};
